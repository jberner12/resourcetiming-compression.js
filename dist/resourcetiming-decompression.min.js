!function(e){"use strict";var t,r;void 0!==e&&(r=(t=e).ResourceTimingDecompression);var p={HOSTNAMES_REVERSED:!0,INITIATOR_TYPES:{other:0,img:1,link:2,script:3,css:4,xmlhttprequest:5,html:6,image:7,beacon:8,fetch:9,iframe:"a",subdocument:"a",body:"b",input:"c",frame:"a",object:"d",video:"e",audio:"f",source:"g",track:"h",embed:"i",eventsource:"j",navigation:6},DIMENSION_NAMES:{height:0,width:1,y:2,x:3,naturalHeight:4,naturalWidth:5},SCRIPT_ATTRIBUTES:{scriptAsync:1,scriptDefer:2,scriptBody:4},REL_TYPES:{prefetch:1,preload:2,prerender:3,stylesheet:4},getRevMap:function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}};p.REV_INITIATOR_TYPES=p.getRevMap(p.INITIATOR_TYPES),p.REV_DIMENSION_NAMES=p.getRevMap(p.DIMENSION_NAMES),p.REV_SCRIPT_ATTRIBUTES=p.getRevMap(p.SCRIPT_ATTRIBUTES),p.REV_REL_TYPES=p.getRevMap(p.REL_TYPES),p.SPECIAL_DATA_PREFIX="*",p.SPECIAL_DATA_DIMENSION_TYPE="0",p.SPECIAL_DATA_DIMENSION_PREFIX=p.SPECIAL_DATA_PREFIX+p.SPECIAL_DATA_DIMENSION_TYPE,p.SPECIAL_DATA_SIZE_TYPE="1",p.SPECIAL_DATA_SCRIPT_TYPE="2",p.SPECIAL_DATA_SERVERTIMING_TYPE="3",p.SPECIAL_DATA_LINK_ATTR_TYPE="4",p.SPECIAL_DATA_NAMESPACED_TYPE="5",p.SPECIAL_DATA_SERVICE_WORKER_TYPE="6",p.HOSTNAME_REGEX=/^(https?:\/\/)([^/]+)(.*)/,p.searchSortedFirst=function(e,t,r){if(!e||0===e.length)return-1;t=(r=r||function(e){return e})(t);for(var s,n=-1,i=e.length;n<i-1;)r(e[s=n+i>>>1])<t?n=s:i=s;return i},p.searchSortedLast=function(e,t,r){if(!e||0===e.length)return-1;t=(r=r||function(e){return e})(t);for(var s,n=-1,i=e.length;n<i-1;)t<r(e[s=n+i>>>1])?i=s:n=s;return n},p.noConflict=function(){return t.ResourceTimingDecompression=r,p},p.decompressResources=function(e,t,r){var s,n=[];for(var i in r=r||"",e)if(e.hasOwnProperty(i)){var o=e[i],a=r+i;if(-1!==a.indexOf("|",a.length-1)&&(a=a.substring(0,a.length-1)),"string"==typeof o){var d=o.split("|");if(0===d.length)continue;s=void 0,this.isDimensionData(d[0])&&(s=this.decompressDimension(d[0]),d=d.splice(1));for(var u=0;u<d.length;u++){var c=d[u];0<c.length&&c[0]===p.SPECIAL_DATA_PREFIX||n.push(this.addDimension(this.decodeCompressedResource(c,a,t),s))}}else var E=this.decompressResources(o,t,a),n=n.concat(E)}return n},p.isDimensionData=function(e){return e&&e.substring(0,p.SPECIAL_DATA_DIMENSION_PREFIX.length)===p.SPECIAL_DATA_DIMENSION_PREFIX},p.decompressDimension=function(e){var t,r,s={};if(!this.isDimensionData(e))return s;if((t=(e=e.substring(p.SPECIAL_DATA_DIMENSION_PREFIX.length)).split(",")).length<2)return s;for(s.y=0,r=s.x=0;r<t.length;r++)""===t[r]?s[this.REV_DIMENSION_NAMES[r]]=0:s[this.REV_DIMENSION_NAMES[r]]=parseInt(t[r],36);return s.hasOwnProperty("naturalHeight")||(s.naturalHeight=s.height),s.hasOwnProperty("naturalWidth")||(s.naturalWidth=s.width),s},p.addDimension=function(e,t){if(!e||!t)return e;for(var r in this.DIMENSION_NAMES)this.DIMENSION_NAMES.hasOwnProperty(r)&&t.hasOwnProperty(r)&&(e[r]=t[r]);return e},p.getSortedCells=function(e){for(var t=[],r=0;r<e.length;r++)e[r].responseEnd<=e[r].startTime||(t.push({ts:e[r].startTime,val:1}),t.push({ts:e[r].responseEnd,val:-1}));return t.sort(function(e,t){return e.ts-t.ts}),t},p.addCellContributions=function(e){for(var t,r=0,s=[],n=e[0].ts,i=e.length,o={},a=0;a<i;a++)o=e[a],a<i-1&&e[a+1].ts===o.ts?(e[a+1].val+=o.val,s.push(a)):(t=o.val,0<r&&(o.val=(o.ts-n)/r),n=o.ts,r+=t);for(a=s.length-1;0<=a;a--)e.splice(s[a],1);return e},p.sumContributions=function(e,t){if(!t||void 0===t.startTime||void 0===t.responseEnd)return 0;var r=t.startTime+1,s=t.responseEnd;function n(e){return e.ts}for(var i=this.searchSortedFirst(e,{ts:r},n),o=this.searchSortedLast(e,{ts:s},n),a=0,d=i;d<=o;d++)a+=e[d].val;return a},p.addContribution=function(e){if(!e||0===e.length)return e;var t=this.getSortedCells(e);if(t.length<2||t[0].val<1||t[t.length-1].ts<=0)return e;this.addCellContributions(t);for(var r=t[t.length-1].ts,s=0;s<e.length;s++)e[s].contribution=this.sumContributions(t,e[s])/r;return e},p.getInitiatorTypeFromIndex=function(e){return this.REV_INITIATOR_TYPES.hasOwnProperty(e)?this.REV_INITIATOR_TYPES[e]:"other"},p.decodeCompressedResource=function(e,t,r){if(!e||!t)return{};p.HOSTNAMES_REVERSED&&(t=p.reverseHostname(t));for(var s=isNaN(parseInt(e[0],10))?e[0]:parseInt(e[0],10),n=0<(e=1<e.length?e.split(p.SPECIAL_DATA_PREFIX):[]).length&&1<e[0].length?e[0].substring(1).split(","):[],i=1<e.length?e.slice(1):[],o=0;o<n.length;o++)""===n[o]?n[o]=0:n[o]=parseInt(n[o],36);var a=1<=n.length?n[0]:0,d=n.length<10?a:this.decodeCompressedResourceTimeStamp(n,9,a),u={name:t,initiatorType:this.getInitiatorTypeFromIndex(s),startTime:a,redirectStart:0<this.decodeCompressedResourceTimeStamp(n,9,a)?a:0,redirectEnd:this.decodeCompressedResourceTimeStamp(n,9,a),fetchStart:d,domainLookupStart:this.decodeCompressedResourceTimeStamp(n,8,a),domainLookupEnd:this.decodeCompressedResourceTimeStamp(n,7,a),connectStart:this.decodeCompressedResourceTimeStamp(n,6,a),secureConnectionStart:this.decodeCompressedResourceTimeStamp(n,5,a),connectEnd:this.decodeCompressedResourceTimeStamp(n,4,a),requestStart:this.decodeCompressedResourceTimeStamp(n,3,a),responseStart:this.decodeCompressedResourceTimeStamp(n,2,a),responseEnd:this.decodeCompressedResourceTimeStamp(n,1,a)};for(u.duration=0<u.responseEnd?u.responseEnd-u.startTime:0,o=0;o<i.length;o++)this.decompressSpecialData(i[o],u,r);return u},p.decodeCompressedResourceTimeStamp=function(e,t,r){return e&&e.length>=t+1&&0!==e[t]?e[t]+r:0},p.decompressScriptType=function(e,t){var r=parseInt(e,10);for(var s in t=t||{},this.SCRIPT_ATTRIBUTES)this.SCRIPT_ATTRIBUTES.hasOwnProperty(s)&&(t[s]=(r&this.SCRIPT_ATTRIBUTES[s])===this.SCRIPT_ATTRIBUTES[s]);return t},p.decompressLinkAttrType=function(e,t){var r=parseInt(e,10);return t=t||{},this.REV_REL_TYPES.hasOwnProperty(r)&&(t.rel=this.REV_REL_TYPES[r]),t},p.decompressSize=function(e,t){var r,s;for(void 0===t&&(t={}),r=e.split(","),s=0;s<r.length;s++)"_"===r[s]?r[s]=0:(""===r[s]&&(r[s]=0),r[s]=parseInt(r[s],36),0<s&&(r[s]+=r[0]));return 1===r.length&&r.push(r[0]),2===r.length&&r.push(r[0]),t.encodedBodySize=r[0],t.transferSize=r[1],t.decodedBodySize=r[2],t},p.decompressNamespacedData=function(e,t){var r,s,n;return t=t||{},"string"==typeof e&&(0<(r=e.indexOf(":"))&&(s=e.substring(0,r),n=e.substring(r+":".length),t._data=t._data||{},t._data.hasOwnProperty(s)?(Array.isArray(t._data[s])||(t._data[s]=[t._data[s]]),t._data[s].push(n)):t._data[s]=n)),t},p.decompressServiceWorkerData=function(e,t){var r,s;return t=t||{},"string"==typeof e&&(r=e.split(","),s=parseInt(r[0],36),t.workerStart=t.startTime+s,r[1]&&(t.fetchStart=t.startTime+parseInt(r[1],36))),t},p.decompressSpecialData=function(e,t,r){var s;return e&&0!==e.length&&(s=e[0],e=e.substring(1),s===p.SPECIAL_DATA_SIZE_TYPE?t=this.decompressSize(e,t):s===p.SPECIAL_DATA_SCRIPT_TYPE?t=this.decompressScriptType(e,t):s===p.SPECIAL_DATA_SERVERTIMING_TYPE?t=this.decompressServerTimingEntries(r,e,t):s===p.SPECIAL_DATA_LINK_ATTR_TYPE?t=this.decompressLinkAttrType(e,t):s===p.SPECIAL_DATA_NAMESPACED_TYPE?t=this.decompressNamespacedData(e,t):s===p.SPECIAL_DATA_SERVICE_WORKER_TYPE&&(t=this.decompressServiceWorkerData(e,t))),t},p.reverseHostname=function(e){return e.replace(p.HOSTNAME_REGEX,function(e,t,r,s){return t+p.reverseString(r)+s})},p.reverseString=function(e){for(var t=e.length,r="";t--;)r+=e[t];return r},p.decompressServerTimingEntries=function(t,e,r){return void 0===r&&(r={}),t&&e&&(r.serverTiming=e.split(",").map(function(e){return this.decompressServerTiming(t,e)},this)),r},p.decompressServerTiming=function(e,t){var r,s=t.split(":"),n=Number(s[0]),i=0,o=0;1<s.length&&(""!==(r=s[1].split("."))[0]&&(i=Number(r[0])),1<r.length&&(o=Number(r[1])));var a,d="";return Array.isArray(e[i])?(a=e[i][0],d=e[i][1+o]||""):a=e[i],{name:a,duration:n,description:d}},"function"==typeof define&&define.amd?define([],function(){return p}):"undefined"!=typeof module&&module.exports?module.exports=p:void 0!==t&&(t.ResourceTimingDecompression=p)}("undefined"!=typeof window?window:void 0);